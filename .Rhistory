round((1.0091927889-1)*100,2)
round((2.9672915619-1)*100,2)
round((3.2371838604-1)*100,2)
#unrestricted model performance
unrestr_probs <- predict(lr_fit,  wwines[-train_indices,], type="response")
unrestr_preds <- ifelse(unrestr_probs > th,"high","low")
unrestr_cm <- confusionMatrix(factor(unrestr_preds),
wwines[-train_indices,]$quality,
positive = "high"
)
unrestr_performance <- list(unrestr_cm$overall[1], unrestr_cm$byClass[1], unrestr_cm$byClass[2])
#restricted model performance
restr_probs <- predict(lr_fit_res,  wwines.res[-train_indices,], type="response")
restr_preds <- ifelse(restr_probs > th,"high","low")
restr_cm <- confusionMatrix(factor(restr_preds),                         wwines[-train_indices,]$quality,
positive = "high"
)
restr_performance <- list(restr_cm$overall[1], restr_cm$byClass[1], restr_cm$byClass[2])
data.frame("unrestr_performance" =unlist(unrestr_performance),"restr_performance" = unlist(restr_performance),
"improvement" = unlist(restr_performance)-unlist(unrestr_performance))
knitr::opts_chunk$set(echo = TRUE)
library(plyr)
library(dplyr)
library(ggplot2)
library(gridExtra)
ccancer <- read.csv("~/OneDriveUni/learning/statistical/supervised/cervical_cancer/risk_factors_cervical_cancer.csv")
ccancer[,c(33:36)] <- lapply(ccancer[,c(33:36)], as.factor)
summarytools::dfSummary(ccancer[,(33:36)],graph.col = F,valid.col = F)
numeric <- Filter(is.numeric,ccancer)
character <- Filter(is.character,ccancer)
glimpse(numeric)
glimpse(character)
# chr to num
ccancer[,colnames(character)] <- lapply(ccancer[,colnames(character)], as.numeric)
# num to factor
unique_count <- sapply(ccancer, function(x) length(unique(x)))
to_factorize <- data.frame(var = colnames(ccancer),unique_count) %>% dplyr::filter(unique_count <= 3) %>% arrange(unique_count)
to_factorize
ccancer[,to_factorize$var] <- lapply(ccancer[,to_factorize$var], as.factor)
geninfo <- ccancer[,1:11]
summarytools::dfSummary(geninfo,graph.col = F,valid.col = F)
mu_age_H <- ddply(ccancer, "Hinselmann", summarise, grp.mean=mean(Age))
mu_age_S <- ddply(ccancer, "Schiller", summarise, grp.mean=mean(Age))
mu_age_C <- ddply(ccancer, "Citology", summarise, grp.mean=mean(Age))
mu_age_B <- ddply(ccancer, "Biopsy", summarise, grp.mean=mean(Age))
# Change density plot line colors by groups
H <- ggplot(ccancer, aes(x=Age, fill=Hinselmann)) +
geom_density(alpha=0.4) +
geom_vline(data=mu_age_H, aes(xintercept=grp.mean, color=Hinselmann),
linetype="dashed")
S <- ggplot(ccancer, aes(x=Age, fill=Schiller)) +
geom_density(alpha=0.4) +
geom_vline(data=mu_age_S, aes(xintercept=grp.mean, color=Schiller),
linetype="dashed")
C <- ggplot(ccancer, aes(x=Age, fill=Citology)) +
geom_density(alpha=0.4) +
geom_vline(data=mu_age_C, aes(xintercept=grp.mean, color=Citology),
linetype="dashed")
B <- ggplot(ccancer, aes(x=Age, fill=Biopsy)) +
geom_density(alpha=0.4) +
geom_vline(data=mu_age_B, aes(xintercept=grp.mean, color=Biopsy),
linetype="dashed")
grid.arrange(H,S,C,B, ncol = 2, nrow = 2)
cors <- cor(Filter(is.numeric,geninfo),use = "complete.obs")
corrplot.mixed(cors, lower = "number", upper = "circle", tl.pos = "lt", tl.cex = 0.7, tl.col = "black")
library(corrplot)
cors <- cor(Filter(is.numeric,geninfo),use = "complete.obs")
corrplot.mixed(cors, lower = "number", upper = "circle", tl.pos = "lt", tl.cex = 0.7, tl.col = "black")
par(mfrow = c(2, 2))
plot(xtabs(~Hinselmann+Smokes, data=ccancer),main = "Hinselmann",col=c("#66cc99","#ff6666"))
plot(xtabs(~Schiller+Smokes, data=ccancer),main = "Schiller",col=c("#66cc99","#ff6666"))
plot(xtabs(~Citology+Smokes, data=ccancer),main = "Citology",col=c("#66cc99","#ff6666"))
plot(xtabs(~Biopsy+Smokes, data=ccancer),main = "Biopsy",col=c("#66cc99","#ff6666"))
tab_C <- xtabs(~Citology+Smokes, data=ccancer)
tab_C
prop.table(tab_C,2)
par(mfrow = c(2, 2))
plot(xtabs(~Hinselmann+Hormonal.Contraceptives, data=ccancer),main = "Hinselmann",col=c("#66cc99","#ff6666"))
plot(xtabs(~Schiller+Hormonal.Contraceptives, data=ccancer),main = "Schiller",col=c("#66cc99","#ff6666"))
plot(xtabs(~Citology+Hormonal.Contraceptives, data=ccancer),main = "Citology",col=c("#66cc99","#ff6666"))
plot(xtabs(~Biopsy+Hormonal.Contraceptives, data=ccancer),main = "Biopsy",col=c("#66cc99","#ff6666"))
STDinfo <- ccancer[,(12:28)]
summarytools::dfSummary(STDinfo, graph.col = F, valid.col = F)
ccancer[,c("STDs.AIDS","STDs.cervical.condylomatosis","STDs..Time.since.first.diagnosis","STDs..Time.since.last.diagnosis")] <-  NULL
STDinfo[,c("STDs.AIDS","STDs.cervical.condylomatosis","STDs..Time.since.first.diagnosis","STDs..Time.since.last.diagnosis")] <-  NULL
cors <- cor(Filter(is.numeric,STDinfo),use = "complete.obs")
corrplot.mixed(cors, lower = "number", upper = "circle", tl.pos = "d", tl.cex = 0.7, tl.col = "black")
ccancer[,"STDs..Number.of.diagnosis"] <-  NULL
STDinfo[,"STDs..Number.of.diagnosis"] <-  NULL
H_num <- ggplot(na.omit(ccancer, col = c("STDs..number.")),
aes(x = factor(STDs..number.),fill = Hinselmann)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
S_num <- ggplot(na.omit(ccancer, col = c("STDs..number.")),
aes(x = factor(STDs..number.),fill = Schiller)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
C_num <- ggplot(na.omit(ccancer, col = c("STDs..number.")),
aes(x = factor(STDs..number.),fill = Citology)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
B_num <- ggplot(na.omit(ccancer, col = c("STDs..number.")),
aes(x = factor(STDs..number.),fill = Biopsy)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
grid.arrange(H_num,S_num,C_num,B_num, ncol = 2)
H_num <- ggplot(na.omit(ccancer, col = c("STDs.condylomatosis")),
aes(x = factor(STDs.condylomatosis),fill = Hinselmann)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
S_num <- ggplot(na.omit(ccancer, col = c("STDs.condylomatosis")),
aes(x = factor(STDs.condylomatosis),fill = Schiller)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
C_num <- ggplot(na.omit(ccancer, col = c("STDs.condylomatosis")),
aes(x = factor(STDs.condylomatosis),fill = Citology)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
B_num <- ggplot(na.omit(ccancer, col = c("STDs.condylomatosis")),
aes(x = factor(STDs.condylomatosis),fill = Biopsy)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
grid.arrange(H_num,S_num,C_num,B_num, ncol = 2)
library(GoodmanKruskal)
plot(GKtauDataframe(Filter(is.factor,STDinfo)))
Dxinfo <- ccancer[,(24:27)]
summarytools::dfSummary(Dxinfo, graph.col = F, valid.col = F)
prcomp(na.omit(ccancer), scale = TRUE)
library(PCAmixdata)
install.packages(PCAmixdata)
install.packages("PCAmixdata")
## Split mixed dataset into quantitative and qualitative variables
## For now excluding the target variable "Churn", which will be added later as a supplementary variable
split <- splitmix(ccancer[1:27])
library(PCAmixdata)
## Split mixed dataset into quantitative and qualitative variables
## For now excluding the target variable "Churn", which will be added later as a supplementary variable
split <- splitmix(ccancer[1:27])
## PCA
res.pcamix <- PCAmix(X.quanti=split$X.quanti,
X.quali=split$X.quali,
rename.level=TRUE,
graph=FALSE,
ndim=25)
## Inspect principal components
res.pcamix$eig
fviz_famd_ind(res.pcamix,
col.ind = "#2eb135",
label = "none",
repel = TRUE) +
xlim(-5, 5) + ylim (-4.5, 4.5)
library(FactoMineR)
fviz_famd_ind(res.pcamix,
col.ind = "#2eb135",
label = "none",
repel = TRUE) +
xlim(-5, 5) + ylim (-4.5, 4.5)
## PCA
res.famd <- FAMD(ccancer,
sup.var = c(28,29,30,31),  ## Set the target variable "Churn" as a supplementary variable, so it is not included in the analysis for now
graph = FALSE,
ncp=25)
library(car)
vif(ccancer)
library(leaps)
regfit.full=regsubsets(Hinselmann~.,data=ccancer[,-c(29,30,31)], nvmax=13) ## default is 8
reg.summary=summary(regfit.full)
set.seed(42)
train_indices<- createDataPartition(ccancer$Hinselmann,p=0.7,list=FALSE)
set.seed(42)
sample <- sample.int(n = nrow(ccancer), size = floor(.75*nrow(ccancer)), replace = F)
train <- ccancer[sample, ]
test  <- ccancer[-sample, ]
fit_H <- glm(Hinselmann ~., data = train[,-c(29,30,31)],
family=binomial(link='logit'))
fit_H <- glm(Hinselmann ~., data = train[,-c(28,29,30,31)],
family=binomial(link='logit'))
fit_H <- glm(Hinselmann ~., data = train[,-c(29,30,31)],
family=binomial(link='logit'))
summarytools::dfSummary(ccancer, graph.col = F, valid.col = F)
length(STDinfo[complete.cases(STDinfo[,1:14]),])
lenght(STDinfo[complete.cases(STDinfo[,1:14]),])
length(STDinfo[complete.cases(STDinfo[,1:14]),])
View(STDinfo)
length(STDinfo[complete.cases(STDinfo[,1]),])
nrow(STDinfo[complete.cases(STDinfo[,1]),])
858-753
STDinfo_clean <- nrow(STDinfo[complete.cases(STDinfo[,1]),])
dfSummary(STDinfo_clean, graph.col = F, valid.col = F)
summarytools::dfSummary(STDinfo_clean, graph.col = F, valid.col = F)
STDinfo_clean <- STDinfo[complete.cases(STDinfo[,1]),]
summarytools::dfSummary(STDinfo_clean, graph.col = F, valid.col = F)
ccancer_clean <- ccancer[complete.cases(STDinfo[,1]),]
summarytools::dfSummary(ccancer_clean, graph.col = F, valid.col = F)
STDinfo_clean <- STDinfo[complete.cases(STDinfo[,1]),]
summarytools::dfSummary(ccancer_clean, graph.col = F, valid.col = F)
cors <- cor(Filter(is.numeric,STDinfo),use = "complete.obs")
corrplot.mixed(cors, lower = "number", upper = "circle", tl.pos = "d", tl.cex = 0.7, tl.col = "black")
H_num <- ggplot(na.omit(ccancer, col = c("STDs..number.")),
aes(x = factor(STDs..number.),fill = Hinselmann)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
S_num <- ggplot(na.omit(ccancer, col = c("STDs..number.")),
aes(x = factor(STDs..number.),fill = Schiller)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
C_num <- ggplot(na.omit(ccancer, col = c("STDs..number.")),
aes(x = factor(STDs..number.),fill = Citology)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
B_num <- ggplot(na.omit(ccancer, col = c("STDs..number.")),
aes(x = factor(STDs..number.),fill = Biopsy)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
grid.arrange(H_num,S_num,C_num,B_num, ncol = 2)
H_num <- ggplot(na.omit(ccancer, col = c("STDs.condylomatosis")),
aes(x = factor(STDs.condylomatosis),fill = Hinselmann)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
S_num <- ggplot(na.omit(ccancer, col = c("STDs.condylomatosis")),
aes(x = factor(STDs.condylomatosis),fill = Schiller)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
C_num <- ggplot(na.omit(ccancer, col = c("STDs.condylomatosis")),
aes(x = factor(STDs.condylomatosis),fill = Citology)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
B_num <- ggplot(na.omit(ccancer, col = c("STDs.condylomatosis")),
aes(x = factor(STDs.condylomatosis),fill = Biopsy)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
grid.arrange(H_num,S_num,C_num,B_num, ncol = 2)
Dxinfo <- ccancer[,(24:27)]
summarytools::dfSummary(Dxinfo, graph.col = F, valid.col = F)
ggplot(ccancer_clean,
aes(x = factor(STDs..number.),fill = Hinselmann)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
H_num <- ggplot(ccancer_clean,
aes(x = factor(STDs..number.),fill = Hinselmann)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
S_num <- ggplot(ccancer_clean,
aes(x = factor(STDs..number.),fill = Schiller)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
C_num <- ggplot(ccancer_clean,
aes(x = factor(STDs..number.),fill = Citology)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
B_num <- ggplot(ccancer_clean,
aes(x = factor(STDs..number.),fill = Biopsy)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
grid.arrange(H_num,S_num,C_num,B_num, ncol = 2)
H_num <- ggplot(ccancer_clean,
aes(x = factor(STDs.condylomatosis),fill = Hinselmann)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
S_num <- ggplot(ccancer_clean,
aes(x = factor(STDs.condylomatosis),fill = Schiller)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
C_num <- ggplot(ccancer_clean,
aes(x = factor(STDs.condylomatosis),fill = Citology)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
B_num <- ggplot(ccancer_clean,
aes(x = factor(STDs.condylomatosis),fill = Biopsy)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
grid.arrange(H_num,S_num,C_num,B_num, ncol = 2)
Dxinfo <- ccancer_clean[,(24:27)]
summarytools::dfSummary(Dxinfo, graph.col = F, valid.col = F)
set.seed(42)
sample <- sample.int(n = nrow(ccancer_clean), size = floor(.75*nrow(ccancer_clean)), replace = F)
train <- ccancer_clean[sample, ]
test  <- ccancer_clean[-sample, ]
fit_H <- glm(Hinselmann ~., data = train[,-c(29,30,31)],
family=binomial(link='logit'))
summarytools::dfSummary(ccancer_clean, graph.col = F, valid.col = F)
summarytools::dfSummary(na.omit(ccancer_clean), graph.col = F, valid.col = F)
summarytools::dfSummary(na.omit(train), graph.col = F, valid.col = F)
fit_H <- glm(Hinselmann ~., data = na.omit(train[,-c(29,30,31)]),
family=binomial(link='logit'))
fit_H <- glm(Hinselmann ~., data = train[,-c(22,29,30,31)],
family=binomial(link='logit'))
summarytools::dfSummary(na.omit(test), graph.col = F, valid.col = F)
summarytools::dfSummary(na.omit(train), graph.col = F, valid.col = F)
summary(fit_H)
vif(lr_H)
vif(fit_H)
ld.vars <- attributes(alias(fit_H)$Complete)$dimnames[[1]]
ld.vars
alias(fit_H)
ld.vars
attributes(alias(fit_H)$Complete)
ld.vars
fit_H <- glm(Hinselmann ~., data = train[,-c(22,29,30,31)],
family=binomial(link='logit'))
ld.vars
ccancer_clean[,"STDs.vulvo.perineal.condylomatosis"] <-  NULL
train[,"STDs.vulvo.perineal.condylomatosis"] <-  NULL
STDinfo[,"STDs.vulvo.perineal.condylomatosis"] <-  NULL
View(train)
fit_H <- glm(Hinselmann ~., data = train[,-c(21,28,29,30)],
family=binomial(link='logit'))
ld.vars <- attributes(alias(fit_H)$Complete)$dimnames[[1]]
ld.vars
vif(fit_H)
ccancer_clean[,"STDs.HPV1"] <-  NULL
train[,"STDs.HPV1"] <-  NULL
STDinfo[,"STDs.HPV1"] <-  NULL
ccancer_clean[,"STDs.HPV"] <-  NULL
train[,"STDs.HPV"] <-  NULL
STDinfo[,"STDs.HPV"] <-  NULL
fit_H <- glm(Hinselmann ~., data = train[,-c(21,27,28,29)],
family=binomial(link='logit'))
vif(fit_H)
sqrt(vif(fit_H))>2
as.data.table(sqrt(vif(fit_H))>2)
library(data.table)
as.data.table(sqrt(vif(fit_H))>2)
as.data.table(var = colnames(train[,-c(21,27,28,29)]), sqrt(vif(fit_H))>2)
data.frame(var = colnames(train[,-c(21,27,28,29)]), sqrt(vif(fit_H))>2)
colnames(train[,-c(21,27,28,29)]
colnames(train[,-c(21,27,28,29)])
data.frame(sqrt(vif(fit_H))>2)
data.frame(sqrt_vif = sqrt(vif(fit_H))>2)
knitr::opts_chunk$set(echo = TRUE)
library(plyr)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(corrplot)
library(car)
library(leaps)
ccancer <- read.csv("~/OneDriveUni/learning/statistical/supervised/cervical_cancer/risk_factors_cervical_cancer.csv")
ccancer[,c(33:36)] <- lapply(ccancer[,c(33:36)], as.factor)
summarytools::dfSummary(ccancer[,(33:36)],graph.col = F,valid.col = F)
numeric <- Filter(is.numeric,ccancer)
character <- Filter(is.character,ccancer)
glimpse(numeric)
glimpse(character)
# chr to num
ccancer[,colnames(character)] <- lapply(ccancer[,colnames(character)], as.numeric)
# num to factor
unique_count <- sapply(ccancer, function(x) length(unique(x)))
to_factorize <- data.frame(var = colnames(ccancer),unique_count) %>% dplyr::filter(unique_count <= 3) %>% arrange(unique_count)
to_factorize
ccancer[,to_factorize$var] <- lapply(ccancer[,to_factorize$var], as.factor)
geninfo <- ccancer[,1:11]
summarytools::dfSummary(geninfo,graph.col = F,valid.col = F)
mu_age_H <- ddply(ccancer, "Hinselmann", summarise, grp.mean=mean(Age))
mu_age_S <- ddply(ccancer, "Schiller", summarise, grp.mean=mean(Age))
mu_age_C <- ddply(ccancer, "Citology", summarise, grp.mean=mean(Age))
mu_age_B <- ddply(ccancer, "Biopsy", summarise, grp.mean=mean(Age))
# Change density plot line colors by groups
H <- ggplot(ccancer, aes(x=Age, fill=Hinselmann)) +
geom_density(alpha=0.4) +
geom_vline(data=mu_age_H, aes(xintercept=grp.mean, color=Hinselmann),
linetype="dashed")
S <- ggplot(ccancer, aes(x=Age, fill=Schiller)) +
geom_density(alpha=0.4) +
geom_vline(data=mu_age_S, aes(xintercept=grp.mean, color=Schiller),
linetype="dashed")
C <- ggplot(ccancer, aes(x=Age, fill=Citology)) +
geom_density(alpha=0.4) +
geom_vline(data=mu_age_C, aes(xintercept=grp.mean, color=Citology),
linetype="dashed")
B <- ggplot(ccancer, aes(x=Age, fill=Biopsy)) +
geom_density(alpha=0.4) +
geom_vline(data=mu_age_B, aes(xintercept=grp.mean, color=Biopsy),
linetype="dashed")
grid.arrange(H,S,C,B, ncol = 2, nrow = 2)
cors <- cor(Filter(is.numeric,geninfo),use = "complete.obs")
corrplot.mixed(cors, lower = "number", upper = "circle", tl.pos = "lt", tl.cex = 0.7, tl.col = "black")
ccancer[,"Smokes..year."] <-  NULL
STDinfo[,"Smokes..year."] <-  NULL
geninfo[,"Smokes..year."] <-  NULL
par(mfrow = c(2, 2))
plot(xtabs(~Hinselmann+Smokes, data=ccancer),main = "Hinselmann",col=c("#66cc99","#ff6666"))
plot(xtabs(~Schiller+Smokes, data=ccancer),main = "Schiller",col=c("#66cc99","#ff6666"))
plot(xtabs(~Citology+Smokes, data=ccancer),main = "Citology",col=c("#66cc99","#ff6666"))
plot(xtabs(~Biopsy+Smokes, data=ccancer),main = "Biopsy",col=c("#66cc99","#ff6666"))
tab_C <- xtabs(~Citology+Smokes, data=ccancer)
tab_C
prop.table(tab_C,2)
par(mfrow = c(2, 2))
plot(xtabs(~Hinselmann+Hormonal.Contraceptives, data=ccancer),main = "Hinselmann",col=c("#66cc99","#ff6666"))
plot(xtabs(~Schiller+Hormonal.Contraceptives, data=ccancer),main = "Schiller",col=c("#66cc99","#ff6666"))
plot(xtabs(~Citology+Hormonal.Contraceptives, data=ccancer),main = "Citology",col=c("#66cc99","#ff6666"))
plot(xtabs(~Biopsy+Hormonal.Contraceptives, data=ccancer),main = "Biopsy",col=c("#66cc99","#ff6666"))
ccancer[,"Smokes..year."] <-  NULL
ccancer[,"Smokes..years."] <-  NULL
geninfo[,"Smokes..years."] <-  NULL
STDinfo <- ccancer[,(11:27)]
summarytools::dfSummary(STDinfo, graph.col = F, valid.col = F)
ccancer[,c("STDs.AIDS","STDs.cervical.condylomatosis","STDs..Time.since.first.diagnosis","STDs..Time.since.last.diagnosis")] <-  NULL
STDinfo[,c("STDs.AIDS","STDs.cervical.condylomatosis","STDs..Time.since.first.diagnosis","STDs..Time.since.last.diagnosis")] <-  NULL
ccancer_clean <- ccancer[complete.cases(STDinfo[,1]),]
STDinfo_clean <- STDinfo[complete.cases(STDinfo[,1]),]
summarytools::dfSummary(ccancer_clean, graph.col = F, valid.col = F)
cors <- cor(Filter(is.numeric,STDinfo),use = "complete.obs")
corrplot.mixed(cors, lower = "number", upper = "circle", tl.pos = "d", tl.cex = 0.7, tl.col = "black")
ccancer[,"STDs..Number.of.diagnosis"] <-  NULL
STDinfo[,"STDs..Number.of.diagnosis"] <-  NULL
H_num <- ggplot(ccancer_clean,
aes(x = factor(STDs..number.),fill = Hinselmann)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
S_num <- ggplot(ccancer_clean,
aes(x = factor(STDs..number.),fill = Schiller)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
C_num <- ggplot(ccancer_clean,
aes(x = factor(STDs..number.),fill = Citology)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
B_num <- ggplot(ccancer_clean,
aes(x = factor(STDs..number.),fill = Biopsy)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "number of STDs") +
scale_fill_manual(values = c("green","red"))
grid.arrange(H_num,S_num,C_num,B_num, ncol = 2)
H_num <- ggplot(ccancer_clean,
aes(x = factor(STDs.condylomatosis),fill = Hinselmann)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
S_num <- ggplot(ccancer_clean,
aes(x = factor(STDs.condylomatosis),fill = Schiller)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
C_num <- ggplot(ccancer_clean,
aes(x = factor(STDs.condylomatosis),fill = Citology)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
B_num <- ggplot(ccancer_clean,
aes(x = factor(STDs.condylomatosis),fill = Biopsy)) +
geom_bar(position = "fill") +
labs(y = "Proportion", x = "condylomatosis") +
scale_fill_manual(values = c("green","red"))
grid.arrange(H_num,S_num,C_num,B_num, ncol = 2)
library(GoodmanKruskal)
plot(GKtauDataframe(Filter(is.factor,STDinfo)))
Dxinfo <- ccancer_clean[,(24:27)]
summarytools::dfSummary(Dxinfo, graph.col = F, valid.col = F)
plot(GKtauDataframe(Dxinfo))
ccancer_clean[,"Dx.HPV"] <- NULL
Dxinfo[,"Dx.HPV"] <- NULL
set.seed(42)
sample <- sample.int(n = nrow(ccancer_clean), size = floor(.75*nrow(ccancer_clean)), replace = F)
train <- ccancer_clean[sample, ]
test  <- ccancer_clean[-sample, ]
summarytools::dfSummary(na.omit(train), graph.col = F, valid.col = F)
fit_H <- glm(Hinselmann ~., data = train[,-c(21,28,29,30)],
family=binomial(link='logit'))
summary(fit_H)
ld.vars <- attributes(alias(fit_H)$Complete)$dimnames[[1]]
attributes(alias(fit_H)$Complete)$dimnames[[1]]
ccancer_clean[,"STDs.vulvo.perineal.condylomatosis","STDs.HPV"] <-  NULL
ccancer_clean[,c("STDs.vulvo.perineal.condylomatosis","STDs.HPV")] <-  NULL
train[,c("STDs.vulvo.perineal.condylomatosis","STDs.HPV")] <-  NULL
STDinfo[,c("STDs.vulvo.perineal.condylomatosis","STDs.HPV")] <-  NULL
fit_H <- glm(Hinselmann ~., data = train[,-c(20,26,27,28)],
family=binomial(link='logit'))
attributes(alias(fit_H)$Complete)$dimnames[[1]]
summary(fit_H)
vif(fit_H)
data.frame(sqrt_vif = sqrt(vif(fit_H))>2)
ccancer_clean[,"STDs..Number.of.diagnosis"] <-  NULL
set.seed(42)
sample <- sample.int(n = nrow(ccancer_clean), size = floor(.75*nrow(ccancer_clean)), replace = F)
train <- ccancer_clean[sample, ]
test  <- ccancer_clean[-sample, ]
summarytools::dfSummary(na.omit(train), graph.col = F, valid.col = F)
Oil.and.Gas.1932.2014 <- read.csv("~/OneDriveUni/adv_mic_mac/macro/macro_project/Oil and Gas 1932-2014.csv")
View(Oil.and.Gas.1932.2014)
oil_gas <- read.csv("~/OneDriveUni/adv_mic_mac/macro/macro_project/Oil and Gas 1932-2014.csv")
table(oil_gas$eiacty)
View(oil_gas)
